var t=class{constructor(){this.ajax=new XMLHttpRequest}async send(t,e){return new Promise(((s,n)=>{this.ajax.open(t,e),this.ajax.onload=()=>s(JSON.parse(this.ajax.response)),this.ajax.onerror=t=>{console.log(t),n({status:this.ajax.status,message:this.ajax.statusText})},this.ajax.send()}))}};class e{#t="https://api.hnpwa.com/v0";#e=`${this.#t}/news/1.json`;#s=t=>`${this.#t}/item/${t}.json`;constructor(t){this.ajax=t}async getNewsfeeds(){return await this.ajax.send("get",this.#e)}async getNewsItem(t){return await this.ajax.send("get",this.#s(t))}}let s=null;const n={state:(a={currentPage:1},Object.keys(a).forEach((t=>{let e=a[t];const n=new Set;Object.defineProperty(a,t,{get:()=>(s&&n.add(s),e),set(t){e=t,n.forEach((t=>t()))}})})),a),setState(t){for(const[e,s]of Object.entries({...this.state,...t}))this.state[e]=s}};var a;class i{constructor(t,e){const s=document.getElementById(t);if(!s)throw"컨네이너가 없어 UI를 진행하지 못합니다";this.container=s,this.template=e,this.renderTemplate=e,this.htmlList=[],this.effect=[]}updateView(){this.container.innerHTML=this.renderTemplate,this.renderTemplate=this.template}addHtml(t){this.htmlList.push(t)}getHtml(){const t=this.htmlList.join("");return this.clearHtmlList(),t}setTempleateData(t,e){this.renderTemplate=this.renderTemplate.replace(`{{__${t}__}}`,e)}clearHtmlList(){this.htmlList=[]}}const o=new class{constructor(){window.addEventListener("hashchange",this.route.bind(this)),this.routeTable=[],this.defaultRoute=null}addRouterPath(t,e){this.routeTable.push({path:t,page:e})}setDefaultPage(t){this.defaultRoute={path:"",page:t}}route(){const t=location.hash;""===t&&this.defaultRoute&&this.defaultRoute.page.render();for(const e of this.routeTable)if(t.indexOf(e.path)>=0){e.page.render();break}}},r=new class extends i{constructor(s){super(s,'\n<div class="bg-gray-800 mx-auto mb-4 px-2 py-1 sm:px-6 lg:px-8 xl:px-10">\n  <h1 class="text-white text-2xl\t font-bold">Hacker News</h1>\n</div>\n\n<div class="mx-auto px-2 sm:px-6 lg:px-8 xl:px-10">\n  <div class="flex gap-4 max-w-md mx-auto md:max-w-2xl mb-4 items-center">\n  <div class="flex gap-1">\n    <a href="#/page/{{__prev_page__}}">\n      <div class="flex h-10 w-10 transition-colors\t hover:bg-indigo-700 items-center justify-center rounded-md bg-indigo-500 text-white">\n        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">\n          <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5L3 12m0 0l7.5-7.5M3 12h18" />\n        </svg>\n      </div>            \n    </a>\n    <a href="#/page/{{__next_page__}}">\n      <div class="flex h-10 w-10 transition-colors\t hover:bg-indigo-700 items-center justify-center rounded-md bg-indigo-500 text-white">\n        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">\n        <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />\n        </svg>\n      </div>\n    </a>\n  </div>\n\n  <p class="text-base text-slate-600 font-bold">\n    {{__current_page__}} / {{__total_page__}}\n  </p>\n  </div>\n\n  <ul class="space-y-2 mb-4">\n    {{__news_feed__}}\n  </ul>\n\n</div>\n'),this.api=new e(new t),this.feeds=n.state.feeds||null,this.currentPage=null}async init(){this.feeds&&0!==this.feeds.length||await this.setFeeds(),this.currentPage=Number(location.hash.split("/")[2])||1,n.setState({currentPage:this.currentPage})}async setFeeds(){const t=(await this.api.getNewsfeeds()).map((t=>({...t,isRead:!1})));this.feeds=t,n.setState({feeds:t})}async render(){await this.init();const t=this.feeds.length;for(let t=5*(this.currentPage-1);t<5*(this.currentPage-1)+5;t++){const e=this.feeds[t];this.addHtml(`\n      <li class="max-w-md mx-auto bg-white rounded-xl shadow-md overflow-hidden md:max-w-2xl">\n          <a class="block ${e.isRead?"bg-red-50":""} p-8 hover:bg-indigo-50 transition-colors" href="#/news/${e.id}">\n          \n            <p class="uppercase tracking-wide text-base text-indigo-500 font-semibold">\n              ${e.title} (${e.comments_count})\n            </p>\n            \n            <div class="flex gap-2 mt-2 items-center"> \n              <p class="text-slate-600">${e.user}</p>\n              <p class="text-slate-500 font-light">${e.time_ago}</p>\n            </div>\n            \n          </a>\n      </li>\n      `)}this.setTempleateData("news_feed",this.getHtml()),this.setTempleateData("prev_page",n.state.currentPage>1?String(n.state.currentPage-1):String(1)),this.setTempleateData("next_page",n.state.currentPage>=t/5?String(t/5):String(n.state.currentPage+1)),this.setTempleateData("current_page",String(n.state.currentPage)),this.setTempleateData("total_page",String(t/5)),this.updateView()}}("app"),l=new class extends i{constructor(s){super(s,'\n<div class="bg-gray-800 mx-auto mb-4 px-2 py-1 sm:px-6 lg:px-8 xl:px-10">\n  <h1 class="text-white text-2xl\tfont-bold">Hacker News</h1>\n</div>\n\n<div class="mx-auto px-2 sm:px-6 lg:px-8 xl:px-10">\n<div class="max-w-md mx-auto md:max-w-2xl mb-4 items-center">\n  <h1 class="text-lg font-bold mb-4">{{__title__}}</h1>\n\n  <div class="mb-4 flex w-full justify-between">\n    <span class="text-sm text-indigo-800">{{__user__}}</span>\n    <span class="text-sm text-indigo-800">{{__time_ago__}}</span>\n  </div>\n  \n  <div class="mb-4">\n    {{__content__}}\n  </div>\n\n  <a class="mt-2 transition-colors inline-flex items-center h-9 rounded-md text-sm font-semibold whitespace-nowrap px-3 focus:outline-none focus:ring-2 bg-indigo-50 text-indigo-600 hover:bg-indigo-100 hover:text-indigo-700 focus:ring-indigo-600 dark:bg-slate-700 dark:text-slate-100 dark:hover:bg-slate-600 dark:hover:text-white dark:focus:ring-slate-500" href="#/page/{{__current_page__}}">목록으로</a>\n\n  <div class="mt-4">\n    <h2 class="mb-2 font-semibold text-indigo-500 dark:text-indigo-400">Comments</h2>\n    <div>\n      {{__comments__}}\n    </div>\n  </div>\n</div>\n'),this.api=new e(new t),this.content=null,this.id=null}makeComments(t,e=0){for(let s=0;s<t.length;s++){const{user:n,content:a,time_ago:i,title:o,comments:r,comments_count:l}=t[s];this.addHtml(`\n      <div class="ml-${4*e} relative z-10">\n      \n        <div class="relative z-10 pb-2">\n          <div class="relative mb-2 py-2 px-6 bg-white rounded-md shadow-xl ring-1 ring-slate-900/5 divide-y divide-slate-100 my-auto xl:mt-18 dark:bg-slate-800 dark:divide-slate-200/5 dark:highlight-white/10">\n            <div class="py-2">${a}</div>\n            <div class="py-2 flex w-full justify-between">\n              <span class="text-sm text-indigo-800">${i}</span>\n              <span class="text-sm text-indigo-800">${n}</span>\n            </div>\n          </div>\n        </div>\n      </div>`),l>0&&this.addHtml(this.makeComments(r,e+1))}return this.getHtml()}async getContent(){const t=location.hash.split("/")[2];this.id=Number(t);const e=await this.api.getNewsItem(Number(t));n.setState({feeds:n.state.feeds?.map((t=>(t.id===this.id&&(t.isRead=!0),t)))}),this.content=e}async render(){await this.getContent(),this.content&&(this.setTempleateData("title",this.content.title),this.setTempleateData("user",this.content.user||""),this.setTempleateData("time_ago",this.content.time_ago),this.setTempleateData("content",this.content.content),this.setTempleateData("comments",this.makeComments(this.content.comments)),this.setTempleateData("current_page",String(n.state.currentPage))),this.updateView()}}("app");o.setDefaultPage(r),o.addRouterPath("/page/",r),o.addRouterPath("/news/",l),o.route();
//# sourceMappingURL=index.3bb4ff63.js.map
